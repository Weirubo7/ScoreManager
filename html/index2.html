<!-- //魏儒波、贾战培完成 -->



<!-- <html>
<body>
<form action="http://127.0.0.1:8081/process_get" method="GET">
First Name: <input type="text" name="first_name">  <br>
 
Last Name: <input type="text" name="last_name">
<input type="submit" value="Submit">
</form>
</body>
</html> -->
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>Bootstrap 101 Template</title>

    <!-- Bootstrap -->
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <!-- 引入bootstrap样式 -->
<link href="https://cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
<!-- 引入bootstrap-table样式 -->
<link href="https://cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.min.css" rel="stylesheet">

    <!-- HTML5 shim 和 Respond.js 是为了让 IE8 支持 HTML5 元素和媒体查询（media queries）功能 -->
    <!-- 警告：通过 file:// 协议（就是直接将 html 页面拖拽到浏览器中）访问页面时 Respond.js 不起作用 -->
    <!--[if lt IE 9]>
      <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <h1 class="text-muted">学生成绩管理系统</h1>

    <!-- <table class="table table-bordered">
    <tr><td>学号</td><td>姓名</td><td>科目</td><td>成绩</td><td>操作</td></tr>
    <tr><td>学号</td><td>姓名</td><td>科目</td><td>成绩</td><td>操作</td></tr>
    <tr><td>学号</td><td>姓名</td><td>科目</td><td>成绩</td><td>操作</td></tr>
    <tr><td>学号</td><td>姓名</td><td>科目</td><td>成绩</td><td>操作</td></tr>
    </table> -->

    <div id="table-query-wrapper" class="clearfix">
    <!-- <div class="row time-choose" id="time-choose" >
        时间选择
        <div class="col-xs-5">
            <div class="form-group">
                <div class='input-group date' id='datetimeStart'>
                    <span class="input-group-addon">开始时间</span>
                    <input type='text' class="form-control" id="inputStartTime" value="2018-05-12 00:00" />
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>
            </div>
        </div>
        <div class="col-xs-5">
            <div class="form-group">
                <div class='input-group date' id='datetimeEnd'>
                    <span class="input-group-addon">结束时间</span>
                    <input type='text' class="form-control" id="inputEndTime" value="2018-05-13 00:00" />
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                </div>
            </div>
        </div>
        <div class="col-xs-2 search">
            <button type="button" class="btn btn-primary" id="search">
                <i class="glyphicon glyphicon-search"></i> 查询</button>
        </div>
    </div> -->

    
    <div class="table-data" id="table-export">
            <div id="toolbar_xmdm" class="btn-group">
                    <button type="button" class="btn" data-toggle="modal" data-target="#myModal">
                            添加学生
                          </button>
                </div>
    
        <table id="table" data-classes="table table-hover table-striped table-sm" data-show-columns="true" data-show-refresh="false"
            data-show-toggle="false" data-show-export="true" data-click-to-select="true" data-toggle="table"
            data-search="true" data-toolbar="#toolbar_xmdm">
        </table>
    </div>
    
          <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title" id="myModalLabel">添加学生记录</h4>
                </div>
                <div class="modal-body">
                        <form action="./addRecord" method="post">
                                <div class="form-group">
                                  <label for="exampleInputEmail1">学号</label>
                                  <input type="text" class="form-control" id="exampleInputEmail1" placeholder="学号">
                                </div>
                                <div class="form-group">
                                        <label for="exampleInputEmail2">姓名</label>
                                        <input type="text" class="form-control" id="exampleInputEmail2" placeholder="姓名">
                                </div>
                                <div class="form-group">
                                        <label for="exampleInputEmail3">科目</label>
                                        <input type="text" class="form-control" id="exampleInputEmail3" placeholder="科目">
                                      </div>
                                <div class="form-group">
                                  <label for="exampleInputPassword4">成绩</label>
                                  <input type="text" class="form-control" id="exampleInputPassword4" placeholder="成绩">
                                </div>
                                <button type="submit" id = "adddStudent" class="btn btn-default" onclick="drawTable()">确定</button>
                              </form>
                </div>
                
                <div class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                  <button type="button" class="btn btn-primary">Save changes</button>
                </div>
              </div>
            </div>
          </div>
          
    </div>


    <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- bootstrap-table.min.js -->
<script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.min.js"></script>
<!-- 引入中文语言包 -->
<script src="https://cdn.bootcss.com/bootstrap-table/1.11.1/locale/bootstrap-table-zh-CN.min.js"></script>

    <script language="JavaScript">

        var table_columns = [{
            checkbox: true, formatter: function (value) {
                // <!--console.info(value);-->
                return value;
            }
        }, {
            field: 'sensor',
            title: '学号',
            align: 'center'
        }, {
            field: 'time',
            title: '姓名',
            align: 'center'
        }, {
            field: 'tem',
            title: '科目',
            align: 'center'
        }, {
            field: 'humidity',
            title: '成绩',
            align: 'center'
        }, {
            field: 'CO2',
            title: '删除',
            align: 'center'
        },{
            field: 'update',
            title: '修改',
            align: 'center'
        }
        ];

        var table_initOpts = {
            columns: table_columns,
            data: "",
            pagination: true,
            queryParamsType: 'limit',
            pageSize: 10,
            pageList: [10, 20, 50, 100],//分页步进值
            exportDataType: "",
            exportOptions: {
                ignoreColumn: [0]//导出时忽略第一列的选中按钮
            },
            exportHiddenCells:true

        };


        $('#table').bootstrapTable(table_initOpts);


        //表格数据导出选项
        $(function () {
            $('#toolbar_xmdm').find('select').change(function () {

                //改变缺省参数设置
                // console.log($(this).val());
                table_initOpts.exportDataType = $(this).val();
                //提取出table中的数据备用
                data = $('#table').bootstrapTable('getData');
                //1 摧毁表，2 用新参数重新初始化表 3 载入备用的数据
                $('#table').bootstrapTable('destroy').bootstrapTable(table_initOpts).bootstrapTable('load', data);

            });
        })

        //表格查询更新
        $(function () {
            $('#addStudent').click(function () {
                // console.log("clicked");
                var a = $('#exampleInputEmail1').val();
                var b = $('#exampleInputEmail2').val();
                var c = $('#exampleInputEmail3').val();
                var d = $('#exampleInputPassword4').val();
                var opt = {
                    url: "/addRecord",
                    silent: true,
                    query: {
                        id: a,
                        name: b,
                        subject: c,
                        score:d

                    }
                };

                $('#table').bootstrapTable('refresh', opt);
            });
        });
            function drawTable(){
                var a = $('#exampleInputEmail1').val();
                var b = $('#exampleInputEmail2').val();
                var c = $('#exampleInputEmail3').val();
                var d = $('#exampleInputPassword4').val();
                $.post('/addRecord',{id: a,name: b,subject: c,score:d},function(data,status){
                    if(status=="success"){
                        $('#table').bootstrapTable('load', data);
                    }
                });
                
            };
            
    </script>
  </body>
</html>